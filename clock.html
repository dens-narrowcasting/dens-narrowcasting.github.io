<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Helmond Clock & Weather</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      font-family: 'Segoe UI', sans-serif;
      color: white;
    }

    /* Background image from your GitHub Pages link */
    .image-bg {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-image: url("https://dens-narrowcasting.github.io/dens_powerhub.png");
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      z-index: -1;
      filter: brightness(0.8);
    }

    .logo {
      position: absolute;
      top: 20px;
      right: 20px;
      width: 450px;
      height: auto;
      z-index: 1;
    }

    .info-container {
      position: absolute;
      bottom: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.5);
      padding: 20px 25px;
      border-radius: 12px;
      font-size: 1.3em;
      line-height: 1.6em;
    }

    .time {
      font-size: 2em;
      font-weight: bold;
    }

    .date, .week, .weather {
      font-size: 1em;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <!-- Background image -->
  <div class="image-bg"></div>

  <!-- DENS logo in top-right -->
  <img class="logo" src="https://www.dens.one/wp-content/uploads/2024/06/dens-logo-white.svg" alt="DENS Logo">

  <div class="info-container">
    <div class="time" id="time"></div>
    <div class="date" id="date"></div>
    <div class="week" id="week"></div>
    <div class="weather" id="weather"></div>
  </div>

  <script>
    function updateClock() {
      const now = new Date();
      const options = {
        timeZone: 'Europe/Amsterdam',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        hour12: false
      };
      const timeString = new Intl.DateTimeFormat('en-GB', options).format(now);

      const dateOptions = {
        timeZone: 'Europe/Amsterdam',
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      };
      const dateString = new Intl.DateTimeFormat('en-GB', dateOptions).format(now);

      const amsNow = new Date(now.toLocaleString('en-US', { timeZone: 'Europe/Amsterdam' }));
      const jan1 = new Date(amsNow.getFullYear(), 0, 1);
      const days = Math.floor((amsNow - jan1) / (24 * 60 * 60 * 1000));
      const weekNumber = Math.ceil((days + jan1.getDay() + 1) / 7);

      document.getElementById('time').textContent = timeString;
      document.getElementById('date').textContent = dateString;
      document.getElementById('week').textContent = `Week ${weekNumber}`;
    }

    async function updateWeather() {
      const lat = 51.479;
      const lon = 5.661;
      const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,apparent_temperature,relative_humidity_2m,weathercode&timezone=Europe%2FAmsterdam`;

      try {
        const response = await fetch(url);
        const data = await response.json();
        const current = data.current;

        const temp = current.temperature_2m;
        const feels = current.apparent_temperature;
        const humidity = current.relative_humidity_2m;
        const code = current.weathercode;

        const { description, emoji } = getWeatherDescription(code);
        const weatherText = `${emoji} Helmond: ${description}, ${temp}°C (feels like ${feels}°C), humidity ${humidity}%`;
        document.getElementById('weather').textContent = weatherText;
      } catch (error) {
        document.getElementById('weather').textContent = "Weather data not available.";
      }
    }

    function getWeatherDescription(code) {
      const map = {
        0: { description: "Clear sky", emoji: "☀️" },
        1: { description: "Mainly clear", emoji: "🌤️" },
        2: { description: "Partly cloudy", emoji: "⛅" },
        3: { description: "Overcast", emoji: "☁️" },
        45: { description: "Fog", emoji: "🌫️" },
        48: { description: "Freezing fog", emoji: "🌫️❄️" },
        51: { description: "Light drizzle", emoji: "🌦️" },
        53: { description: "Drizzle", emoji: "🌦️" },
        55: { description: "Dense drizzle", emoji: "🌧️" },
        61: { description: "Light rain", emoji: "🌦️" },
        63: { description: "Rain", emoji: "🌧️" },
        65: { description: "Heavy rain", emoji: "🌧️💧" },
        71: { description: "Light snow", emoji: "🌨️" },
        73: { description: "Snow", emoji: "❄️" },
        75: { description: "Heavy snow", emoji: "❄️🌨️" },
        80: { description: "Light showers", emoji: "🌦️" },
        81: { description: "Showers", emoji: "🌧️" },
        82: { description: "Heavy showers", emoji: "🌧️💦" }
      };
      return map[code] || { description: "Unknown weather", emoji: "❔" };
    }

    setInterval(updateClock, 1000);
    setInterval(updateWeather, 600000);
    updateClock();
    updateWeather();
  </script>
</body>
</html>

